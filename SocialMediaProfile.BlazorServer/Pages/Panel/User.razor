@page "/{alias}"
@inject IGlobalWebService GlobalWebService;
@inject IUserWebService UserWebService;
@inject UserAuthenticationStateProvider AuthStateProvider;

<Banner></Banner>

<PersonalInfo Alias="@(Alias)"></PersonalInfo>

<section id="tecnologías" class="container" style="padding-top: 72px;">
    <article class="row">
        <div class="col-3 bg-dark d-flex flex-column justify-content-start row-gap-4 pt-4 pb-4">
            <div class="card text-bg-dark" style="height: 18.75%;">
                <img src="paisaje1.jpg" class="card-img object-fit-cover h-100" alt="...">
                <div class="card-img-overlay d-flex justify-content-center align-items-center">
                    <h3 class="card-title">Mi CV</h3>
                </div>
            </div>
            <div class="card text-bg-dark" style="height: 18.75%;">
                <img src="paisaje2.jpg" class="card-img object-fit-cover h-100" alt="...">
                <div class="card-img-overlay d-flex justify-content-center align-items-center">
                    <h3 class="card-title">Mi GitHub</h3>
                </div>
            </div>
            <div class="card text-bg-dark" style="height: 25%;">
                <img src="paisaje3.jpg" class="card-img object-fit-cover h-100" alt="...">
                <div class="card-img-overlay d-flex justify-content-center align-items-center">
                    <h3 class="card-title">Mis Certificaciones</h3>
                </div>
            </div>
            <div class="card text-bg-dark" style="height: 37.5%;">
                <img src="paisaje4.jpg" class="card-img object-fit-cover h-100" alt="...">
                <div class="card-img-overlay d-flex justify-content-center align-items-center" style="height: 404px;">
                    <h3 class="card-title">Mis Colegas</h3>
                </div>
            </div>
        </div>
        <div class="col-9">
            <Skills Alias="@(Alias)"></Skills>
            <Experiences Alias="@(Alias)"></Experiences>
            <Educations Alias="@(Alias)"></Educations>
        </div>
    </article>
</section>

<Projects Alias="@(Alias)"></Projects>

@code {
    [Parameter]
    public string Alias { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await Task.CompletedTask;

        if (string.IsNullOrEmpty(AuthStateProvider.CurrentRole))
        {
            return;
        }

        if (AuthStateProvider.CurrentRole.Equals("Admin"))
        {
            if (!AuthStateProvider.CurrentAlias.Equals(Alias))
            {
                var user = await UserWebService.GetByAliasAsync(Alias);
                GlobalWebService.UserId = user.Id;
            }
            else
            {
                GlobalWebService.UserId = AuthStateProvider.CurrentUserId;
            }
        }
        else
        {
            if (AuthStateProvider.CurrentAlias.Equals(Alias))
            {
                GlobalWebService.UserId = AuthStateProvider.CurrentUserId;
            }
        }
    }
}
